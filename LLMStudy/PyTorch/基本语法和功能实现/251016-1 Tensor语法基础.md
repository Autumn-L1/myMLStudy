---
jupyter:
  jupytext:
    cell_metadata_filter: -all
    formats: ipynb,md
    main_language: python
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.17.3
---

导入torch库
```python
import torch
```

# 创建Tensor
声明Tensor
```python
x = torch.empty(1)
print(x)

y = torch.empty(3)
print(y)

z = torch.empty(2,3)
print(z)

t = torch.empty(2,2,3)
print(t)
```
初始化Tensor
```python
x = torch.tensor([2,1])
print(x)
print("\n")
#随机数
x = torch.rand(2,2) #[0,1)均匀分布, 若需标准正态分布使用.randn()
print(x)
print("\n")
        
#0和1
x = torch.zeros(2,2)
print(x)
print("\n")
        
x = torch.ones(2,2)
print(x)

```

指定Tensor数据类型：参数dtype
```python
x = torch.ones(2,2)
print(x)
print(x.dtype)
print("\n")

x = torch.ones(2,2,dtype = int)
print(x)
print(x.dtype)
print("\n")

x = torch.ones(2,2,dtype = torch.int)
print(x)
print(x.dtype)
print("\n")

x = torch.ones(2,2,dtype = torch.float16)
print(x)
print(x.dtype)
```
# Tensor简单操作
调用
```python
x = torch.rand(4,4)
print(x)

print("x[:,0]: ",x[:,0])
print("x[0,:]: ",x[0,:])
print("x[1,1]: ",x[1,1])
```
reshape
```python
x = torch.rand(4,4)
print(x)

print("x.view(16): ",x.view(16))
print("x.view(2,8): ",x.view(2,8))

#使用-1来指定自动计算维度常数
print("x.view(-1,8): ",x.view(-1,8))
```
# Tensor简单计算
加
```python
x = torch.tensor([1,2])
y = torch.tensor([10,20])
print("x+y: ",x+y)
print("torch.add(x+y): ",torch.add(x,y))

print("y.add_(x): ",y.add_(x))
print("y after y.add_(x): ",y.add_(x))
```
减
```python
x = torch.tensor([1,2])
y = torch.tensor([10,20])
print("x-y: ",x-y)
print("torch.sub(x+y): ",torch.sub(x,y))

print("y.sub_(x): ",y.sub_(x))
print("y after y.sub_(x): ",y.sub_(x))
```
乘
```python
x = torch.tensor([1,2])
y = torch.tensor([10,20])
print("x*y: ",x*y)
print("torch.mul(x+y): ",torch.mul(x,y))

print("y.mul_(x): ",y.mul_(x))
print("y after y.mul_(x): ",y.mul_(x))
```

# Tensor和Numpy转换
将Tensor转换为np数组
```python
import numpy as np
a = torch.ones(3)
print(a)
b = a.numpy()
print(b)
```

如果tensor在CPU上，那么tensor.numpy()得到的array和原tensor使用相同的地址，所以修改相通
```python
a.add_(1)
print(a)
print(b)

b+=1
print(a)
print(b)
```

将np数组转换tensor
```python
a = np.ones(5)
print(a)
b = torch.from_numpy(a)
print(b)
```

地址问题同理
```python
a+=1
print(a)
print(b)

b.add_(1)
print(a)
print(b)
```

# 改变Tensor位置：CPU/GPU
需要计算机支持cuda
```python
if torch.cuda.is_available(): print("cuda is avaliable")
else: print("cuda is unavaliable")
```

默认tensor在cpu，通过device参数可指定到gpu
```python
device = torch.device("cuda")
x = torch.ones(3, device = device)
y = torch.ones(3)
print(x)
print(y)
```

cpu和gpu上的tensor不能一起运算
```python
print(x+y) #报错
```

在cpu上的tensor可以通过.to()方法产生在gpu上的tensor
```python
yg = y.to(device)
print(x+yg)

```

.to()方法产生的tensor与原tensor间相互独立
```python
yg.add_(x)
print(yg)
print(y)
print("\n")
y.mul_(4)
print(y)
print(yg)
```

np数组仅在cps上，gpu上的tensor无法转化为np数组
```python
z = x+yg
print(z)
print(z.numpy()) #报错
```

如果要将gpu上的tensor转化为np数组，需要先使用.to()方法把tensor转化到cpu上
```python
z = z.to("cpu") #cpu小写
print(z)
print(z.device)
print(z.numpy()) 
```
